@model IEnumerable<PawsHome.Models.Dog>

@{
    ViewBag.Title = "Report";
    Layout = "~/Views/Shared/_Layout.cshtml";
}
<style>
    h2 {
        text-align: center;
        margin: 50px 50px 50px 50px;
        color: brown;
    }

    h4 {
        text-align: center;
        margin: 20px 20px 20px 20px;
        color: brown;
    }

    p {
        font-weight: bolder;
        font: x-large;
        font-style: italic;
    }

    img {
        width: 300px;
        height: 200px;
    }
</style>
<div class="container body-content">
    <h1>Get Started</h1>
    <h2>Select a breed to see how much it might cost</h2>
    <div class="row">
        <div class="col-md-6" style="text-align:right">
            <img src="https://i.loli.net/2019/08/27/Wa7dbYoAyuX1PZk.png" style="height:100%" />
        </div>
        <div class="col-md-6">
            <h3>@Html.DropDownList("Breeds", (IEnumerable<SelectListItem>)ViewBag.Breeds, "----Select----", new { @id = "drop" })</h3>
            <img id="t5" />
            <h4>Estimated Annual Cost</h4>
            <table class="table">
                <thead>
                    <tr>
                        <th>Activity</th>
                        <th>Cost (AUD)</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>Dog Food</td>
                        <td id="t0"></td>
                    </tr>
                    <tr>
                        <td>Dog Health</td>
                        <td id="t1"></td>
                    </tr>
                    <tr>
                        <td>Dog License</td>
                        <td id="t2"></td>
                    </tr>
                    <tr>
                        <td>Miscellaneous</td>
                        <td id="t3"></td>
                    </tr>
                    <tr>
                        <td style="font-weight:800;font-size:larger">Total</td>
                        <td id="t4" style="font-weight:800;font-size:larger"></td>
                    </tr>
                </tbody>
            </table>
            <hr />
            <h4>Time Playing With Dog</h4>
            <div id="t6" style="font-weight:800;font-size:larger"></div>
        </div>
    </div>
    <hr />
    <h2>If you have no idea about which breed might suit you</h2>
    <div class="row">
        <div class="col-md-6">
            <img id="person" style="width:300px;height:300px;float:right;"
                 src="https://cdn.pixabay.com/photo/2016/12/21/08/58/questions-1922476_960_720.jpg">
        </div>
        <div class="col-md-6">
            <p>What is your living conditon?</p>
            <div id="size-group">
                <input type="radio" class="size" name="size" value=5 checked /><span>I live in a house</span>
                <input type="radio" class="size" name="size" value=3 /><span>I live in an apartment</span>
                <input type="radio" class="size" name="size" value=2 /><span>I live with others</span>
            </div>
            <hr />
            <p>What kind of dog do you like?</p>
            <div id="temper-group">
                <input type="radio" class="temper" name="temper" value="Friendly" checked /><span>Friendly</span>
                <input type="radio" class="temper" name="temper" value="Intelligent" /><span>Intelligent</span>
                <input type="radio" class="temper" name="temper" value="Fearless" /><span>Fearless</span>
                <input type="radio" class="temper" name="temper" value="Gentle" /><span>Gentle</span>
                <input type="radio" class="temper" name="temper" value="Loyal" /><span>Loyal</span>
                <input type="radio" class="temper" name="temper" value="Alert" /><span>Alert</span>
                <input type="radio" class="temper" name="temper" value="Brave" /><span>Brave</span>
            </div>
            <hr />
            <p>How much time do you want to spend with your dog each day?</p>
            <div id="exercise-group">
                <input type="radio" class="time" name="time" value=9999 checked /><span>More than 60 minutes</span>
                <input type="radio" class="time" name="time" value=60 /><span>30-60 minutes</span>
                <input type="radio" class="time" name="time" value=30 /><span>Less than 30 minutes</span>
            </div>
            <hr />
            <p>How much money do you want to spend on your dog each year?</p>
            <div id="budget-group">
                <input type="radio" class="budget" name="budget" value=9999 checked /><span>More than 2000 AUD</span>
                <input type="radio" class="budget" name="budget" value=2000 /><span>1500 - 2000 AUD</span>
                <input type="radio" class="budget" name="budget" value=1500 /><span>Less than 1500 AUD</span>
            </div>
            <hr />
            <button class="button button-3d button-primary button-rounded" id="go">
                Go
            </button>
            <hr />
        </div>
    </div>

    <div id="message" style="text-align:center;margin:10px;"></div>
    <div class="row" id="recommend" style="text-align:center"></div>
    <div id="r3" style="text-align:center;margin:10px"></div>

    <a id="b0" name="bottom" href="#bottom"></a>
</div>
@section Scripts{
    <script type="text/javascript">
     //display estimated cost
        $(document).ready(function () {

            //listen dropdown list change
            $("#drop").change(function (evt) {
                if ($("#drop").val() != 0) {
                @foreach (var item in Model)
                {<text>

                    //display cost
                    if ($("#drop").val() == @item.id) {
                        var annual = parseInt(@item.cost * 12);
                        document.getElementById("t0").innerHTML = parseInt(annual * 0.4);
                        document.getElementById("t1").innerHTML = parseInt(annual * 0.28);
                        document.getElementById("t2").innerHTML = 180;
                        document.getElementById("t3").innerHTML = parseInt(annual * 0.3);
                        document.getElementById("t4").innerHTML =
                            parseInt(annual * 0.4) + parseInt(annual * 0.28) + 180 + parseInt(annual * 0.3);
                        document.getElementById("t5").src = "@item.url";
                        document.getElementById("t6").innerHTML = "@item.exercise minutes per day";
                    }
                </text>}
                }

                //if nothing selected, erase info
                else {
                    document.getElementById("picture").src = "";
                    for (var i = 0; i < 7; i++) {
                        document.getElementById("t" + i).innerHTML = "";
                    }
                }
            });

            //recommend
            $("#go").click(function (evt) {
                var breedList = [];
                var urlList = [];
                document.getElementById("recommend").innerHTML = "";
                document.getElementById("message").innerHTML = "";
                document.getElementById("r3").innerHTML = ""; 

                //set info
                document.getElementById("message").innerHTML += "<h4>According to your choices:</h4>";
                document.getElementById("message").innerHTML += "<p>" + $(".size:checked + span").text() + "</p>";
                document.getElementById("message").innerHTML += "<p>I prefer a " + $(".temper:checked + span").text() + " dog</p>";
                document.getElementById("message").innerHTML += "<p>I can spend " + $(".budget:checked + span").text() + " for my dog each year</p>";
                document.getElementById("message").innerHTML += "<p>I can spend " + $(".time:checked + span").text() + " with my dog each day</p>";
                document.getElementById("message").innerHTML += "<h4>Guess you might like</h4>";

                //filter
                @foreach (var item in Model) {<text>
                if ($(".size:checked").val() >= @item.size &&
                    $(".budget:checked").val() >= ((@item.cost * 12)/0.98 + 180) &&
                    $(".time:checked").val() >= @item.exercise &&
                    $(".temper:checked").val() == "@item.temperament" ) {
                    breedList.push("@item.breed");
                    urlList.push("@item.url");
                }
                </text>}

                //display recommended dog
                if (breedList.length > 0) {
                    //set layout
                    var col;
                    if (breedList.length >= 3) {
                        col = 4;
                    }
                    else {
                        col = 12 / breedList.length;
                    }

                    //add element
                    for (var i = 0; i < breedList.length && i < 3; i++) {
                        document.getElementById("recommend").innerHTML += "<div id=\"r" + i + "\" class=\"col-md-" + col + "\"></div>";
                        document.getElementById("r" + i).innerHTML = "<p>" + breedList[i] + "</p>"
                            + "<img src=" + urlList[i] + " />";
                    }
                    document.getElementById("r3").innerHTML = "<button class=\"button button-3d button-primary button-rounded\" id=close>OK</button>";

                    //add close button
                    $("#close").click(function (evt) {
                        document.getElementById("message").innerHTML = "";
                        document.getElementById("recommend").innerHTML = "";
                        document.getElementById("r3").innerHTML = "";
                    });
                }

                //guide to all breeds if no dog matches
                else {
                    document.getElementById("message").innerHTML =
                        "<a class=\"button button-glow button-border button-primary\" href=/Dogs/Index>No breed matches, click here to see more breeds</a>"
                }

                document.getElementById("b0").click();

            });

        });
    </script>
}